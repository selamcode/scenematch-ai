<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SceneMatch</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='chat.css') }}" />
</head>
<body>
  <div class="container">
    <h2>Welcome to SceneMatch ðŸŽ¬</h2>

    <div class="chat" id="chat">
      {% for speaker, message in chat_history %}
        <div class="bubble {{ speaker }}">
          <div class="label"><strong>{{ "You" if speaker == "user" else "MovieBot" }}:</strong></div>
          <div class="message">{{ message|safe }}</div>
        </div>
      {% endfor %}
    </div>

    <!-- Chat Input Form -->
     
    <form method="POST" action="/">
      <input type="text" name="message" placeholder="Ask for a movie..." required autocomplete="off" autofocus />
      <button type="submit">Send</button>
    </form>

   <!-- Feedback Form -->

  {% if chat_history|length >= 2 %}
  <div class="feedback-widget">
    <h4>Rate Response</h4>
    <form method="POST" action="/feedback">
      <input type="hidden" name="user_id" value="anonymous">
      <input type="hidden" name="session_id" value="static-session">
      <input type="hidden" name="user_message" value="{{ chat_history[-2][1] }}">
      <input type="hidden" name="model_response" value="{{ chat_history[-1][1] }}">
      <input type="hidden" name="message_id" value="">

      <label for="rating">Rating:</label>
      <input type="number" name="rating" min="1" max="5" required>

      <label for="comment">Comment:</label>
      <input type="text" name="comment" placeholder="Optional feedback">

      <button type="submit">Submit</button>
    </form>
  </div>
  {% endif %}

  <script>
    const chat = document.getElementById('chat');
    chat.scrollTop = chat.scrollHeight;
  </script>
</body>
</html>
